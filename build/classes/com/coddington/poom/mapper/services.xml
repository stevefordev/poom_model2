<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="services">

	<select id="selectByNo" parameterType="int" resultType="Service">
		SELECT s.no, s.user_no userNo, s.title, s.area1, s.area2, s.detail_address1	detailAddress1, s.detail_address2 detailAddress2,
		s.latitude, s.longitude, s.poom, s.content, s.category, s.photo_url	photoUrl, s.role, s.regdate, u.nick_name userNickName, u.photo_url userPhotoUrl
		FROM services s, users u
		WHERE s.user_no = u.no 
		AND s.no = #{no} 
	</select>
	
<!-- 
SELECT (scoreUser / countDone * 100) scoreTaker, ((scorePrice + scoreKind + scoreKnowhow + scoreHonest) / (4 * countDone) * 100) scoreGiver,
        (scorePrice / countDone * 100) scorePrice, 
        scoreKind  / countDone * 100, 
        scoreKnowhow / countDone * 100, 
        scoreHonest / countDone * 100, 
        countWait, 
        countProgress, 
        countDenied, 
        countStop, 
        countDone
FROM(SELECT
    COUNT(CASE WHEN c.status = 9 AND c.score_user = 1 THEN 1 END) AS scoreUser,
    COUNT(CASE WHEN c.status = 9 AND c.score_price = 1 THEN 1 END) AS scorePrice,
    COUNT(CASE WHEN c.status = 9 AND c.score_kind = 1 THEN 1 END) AS scoreKind,
    COUNT(CASE WHEN c.status = 9 AND c.score_knowhow = 1 THEN 1 END) AS scoreKnowhow,
    COUNT(CASE WHEN c.status = 9 AND c.score_honest = 1 THEN 1 END) AS scoreHonest,
    COUNT(CASE WHEN c.status = 0 THEN 1 END) countWait,
    COUNT(CASE WHEN c.status = 1 THEN 1 END) countProgress,
    COUNT(CASE WHEN c.status = 4 THEN 1 END) countDenied,
    COUNT(CASE WHEN c.status = 5 THEN 1 END) countStop,
    COUNT(CASE WHEN c.status = 9 THEN 1 END) countDone
    FROM 
    services s, contracts c
    WHERE s.no = c.SERVICE_NO
    AND s.no = 1);



 -->
</mapper>


